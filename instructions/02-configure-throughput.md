---
lab:
  title: Azure portal を使用して Azure Cosmos DB SQL API のスループットを構成する
  module: Module 2 - Plan and implement Azure Cosmos DB SQL API
ms.openlocfilehash: 08dca99514789805471e0068fb19d5c9e331f80d
ms.sourcegitcommit: 70795561eb9e26234c0e0ce614c2e8be120135ac
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/28/2022
ms.locfileid: "145919958"
---
# <a name="configure-throughput-for-azure-cosmos-db-sql-api-with-the-azure-portal"></a>Azure portal を使用して Azure Cosmos DB SQL API のスループットを構成する

理解すべき最も重要なことの 1 つは、Azure Cosmos DB SQL API でのスループットの構成です。 Azure Cosmos DB SQL API コンテナーを作成するには、この順序でまずアカウントを作成してから、データベースを作成する必要があります。

このラボでは、データ エクスプローラーでさまざまな方法を使用して、スループットをプロビジョニングします。 スループットは、手動で、または自動スケーリングを使用して、データベースおよびコンテナー レベルでプロビジョニングします。

## <a name="create-a-serverless-account"></a>サーバーレス アカウントを作成する

まず、サーバーレス アカウントを作成しましょう。 すべてがサーバーレスであるため、ここで構成することは多くありません。 データベースとコンテナーを作成するときに、スループットをプロビジョニングする必要はまったくありません。 このアカウントの作成に進めば、そのすべてがわかります。

1. 新しい Web ブラウザー ウィンドウまたはタブで、Azure portal (``portal.azure.com``) に移動します。

1. ご利用のサブスクリプションに関連付けられている Microsoft 資格情報を使用して、ポータルにサインインします。

1. **[Azure サービス]** カテゴリで、 **[リソースの作成]** を選択してから、 **[Azure Cosmos DB]** を選択します。

    > &#128161; または、 **[&#8801;]** メニューを展開し、 **[すべてのサービス]** を選択し、 **[データベース]** カテゴリで、 **[Azure Cosmos DB]** を選んでから **[作成]** を選択します。

1. **[API オプションの選択]** ペインで、 **[コア (SQL - 推奨)]** セクション内の **[作成]** オプションを選択します。

1. **[Azure Cosmos DB アカウントの作成]** ペイン内で、 **[基本]** タブを確認します。

1. **[基本]** タブで、各設定に対して次の値を入力します。

    | **設定** | **値** |
    | --: | :-- |
    | **サブスクリプション** | ''*すべてのリソースはリソース グループに属している必要があります。すべてのリソース グループはサブスクリプションに属している必要があります。ここでは、既存の Azure サブスクリプションを使用します。* '' |
    | **リソース グループ** | ''*すべてのリソースはリソース グループに属している必要があります。ここでは、既存のリソース グループを選択するか、新しいものを作成します。* '' |
    | **アカウント名** | ''*グローバルに一意のアカウント名。この名前は、要求の DNS アドレスの一部として使用されます。グローバルに一意の名前を入力します。ポータルでは、名前がリアルタイムで確認されます。* '' |
    | **Location** | ''*データベースが最初にホストされる地理的リージョンを選択します。使用可能なリージョンを選びます。* '' |
    | **容量モード** | '' *[サーバーレス] を選択します*'' |

1. **[確認と作成]** を選択して **[確認と作成]** タブに移動してから、 **[作成]** を選択します。

    > &#128221; Azure Cosmos DB SQL API アカウントが使用できる状態になるまで、10 分から 15 分かかる場合があります。

1. **[デプロイ]** ペインを確認します。 デプロイが完了すると、そのペインが更新され、 **[デプロイに成功しました]** というメッセージが表示されます。

1. 引き続き **[デプロイ]** ペインで、 **[リソースに移動]** を選択します。

1. **[Azure Cosmos DB アカウント]** ペインで、リソース メニューから **[データ エクスプローラー]** を選択します。

1. **[データ エクスプローラー]** ペインで、 **[新しいコンテナー]** を展開してから、 **[New Database]** を選択します。

1. **[New Database]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **値** |
    | --: | :-- |
    | **データベース ID** | *`cosmicworks`* |

1. **[データ エクスプローラー]** ペインに戻り、階層内の **cosmicworks** データベース ノードを確認します。

1. **[データ エクスプローラー]** ペインで、 **[New Container]** を選択します。

1. **[新しいコンテナー]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **値** |
    | --: | :-- |
    | **データベース ID** | Use existing \| *cosmicworks* |
    | **コンテナー ID** | *`products`* |
    | **パーティション キー** | *`/categoryId`* |

1. **[データ エクスプローラー]** ペインに戻り、**cosmicworks** データベース ノードを展開し、階層内の **products** コンテナー ノードを確認します。

1. Azure portal の **[ホーム]** に戻ります。

## <a name="create-a-provisioned-account"></a>プロビジョニングされたアカウントを作成する

次は、従来の構成オプションを使用してプロビジョニングされたスループット アカウントを作成します。 この種のアカウントを使用すると、少し面倒になる可能性がある構成オプションの世界が開きます。 ここでは、可能なデータベースとコンテナーの組み合わせの例についていくつか説明します。

1. **[Azure サービス]** カテゴリで、 **[リソースの作成]** を選択してから、 **[Azure Cosmos DB]** を選択します。

    > &#128161; または、 **[&#8801;]** メニューを展開し、 **[すべてのサービス]** を選択し、 **[データベース]** カテゴリで、 **[Azure Cosmos DB]** を選んでから **[作成]** を選択します。

1. **[API オプションの選択]** ペインで、 **[コア (SQL - 推奨)]** セクション内の **[作成]** オプションを選択します。

1. **[Azure Cosmos DB アカウントの作成]** ペイン内で、 **[基本]** タブを確認します。

1. **[基本]** タブで、各設定に対して次の値を入力します。

    | **設定** | **値** |
    | --: | :-- |
    | **サブスクリプション** | ''*すべてのリソースはリソース グループに属している必要があります。すべてのリソース グループはサブスクリプションに属している必要があります。ここでは、既存の Azure サブスクリプションを使用します。* '' |
    | **リソース グループ** | ''*すべてのリソースはリソース グループに属している必要があります。ここでは、既存のリソース グループを選択するか、新しいものを作成します。* '' |
    | **アカウント名** | ''*グローバルに一意のアカウント名。この名前は、要求の DNS アドレスの一部として使用されます。グローバルに一意の名前を入力します。ポータルでは、名前がリアルタイムで確認されます。* '' |
    | **Location** | ''*データベースが最初にホストされる地理的リージョンを選択します。使用可能なリージョンを選びます。* '' |
    | **容量モード** | ''*プロビジョニングされたスループットを選択します*'' |
    | **Apply Free Tier Discount (Free レベル割引の適用)** | *適用しない* |
    | **このアカウントでプロビジョニングできるスループットの総量を制限する** | *選択しない* |

1. **[確認と作成]** を選択して **[確認と作成]** タブに移動してから、 **[作成]** を選択します。

    > &#128221; Azure Cosmos DB SQL API アカウントが使用できる状態になるまで、10 分から 15 分かかる場合があります。

1. **[デプロイ]** ペインを確認します。 デプロイが完了すると、そのペインが更新され、 **[デプロイに成功しました]** というメッセージが表示されます。

1. 引き続き **[デプロイ]** ペインで、 **[リソースに移動]** を選択します。

1. **[Azure Cosmos DB アカウント]** ペインで、リソース メニューから **[データ エクスプローラー]** を選択します。

1. **[データ エクスプローラー]** ペインで、 **[New Container]** を展開してから、 **[New Database]** を選択します。

1. **[New Database]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **値** |
    | --: | :-- |
    | **データベース ID** | *`nothroughputdb`* |
    | **スループットのプロビジョニング** | ''*選択しない*'' |

1. **[データ エクスプローラー]** ペインに戻り、階層内の **nothroughputdb** データベース ノードを確認します。

1. **[データ エクスプローラー]** ペインで、 **[New Container]** を選択します。

1. **[New Container]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **値** |
    | --: | :-- |
    | **データベース ID** | Use existing \| *nothroughputdb* |
    | **コンテナー ID** | *`requiredthroughputcontainer`* |
    | **パーティション キー** | *`/primarykey`* |
    | **コンテナーのスループット** | *[Manual]* |
    | **RU/秒** | *`400`* |

1. **[データ エクスプローラー]** ペインに戻り、**nothroughputdb** データベース ノードを展開し、階層内の **requiredthroughputcontainer** コンテナー ノードを確認します。

1. **[データ エクスプローラー]** ペインで、 **[New Container]** を展開してから、 **[New Database]** を選択します。

1. **[New Database]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **値** |
    | --: | :-- |
    | **データベース ID** | *`manualthroughputdb`* |
    | **スループットのプロビジョニング** | ''*選択*'' |
    | **データベースのスループット** | *[Manual]* |
    | **RU/秒** | *`400`* |

1. **[データ エクスプローラー]** ペインに戻り、階層内の **manualthroughputdb** データベース ノードを確認します。

1. **[データ エクスプローラー]** ペインで、 **[New Container]** を選択します。

1. **[New Container]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **値** |
    | --: | :-- |
    | **データベース ID** | Use existing \| *manualthroughputdb* |
    | **コンテナー ID** | *`childcontainer`* |
    | **パーティション キー** | *`/primarykey`* |
    | **このコンテナーの専用スループットをプロビジョニングする** | ''*選択*'' |
    | **コンテナーのスループット** | *[Manual]* |
    | **RU/秒** | *`1000`* |

1. **[データ エクスプローラー]** ペインに戻り、**manualthroughputdb** データベース ノードを展開し、階層内の **childcontainer** コンテナー ノードを確認します。

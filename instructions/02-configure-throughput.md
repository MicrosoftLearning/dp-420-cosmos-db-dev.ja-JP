---
lab:
  title: Azure portal を使用して Azure Cosmos DB for NoSQL のスループットを構成する
  module: Module 2 - Plan and implement Azure Cosmos DB for NoSQL
---

# Azure portal を使用して Azure Cosmos DB for NoSQL のスループットを構成する

理解すべき最も重要なことの 1 つは、Azure Cosmos DB for NoSQL でのスループットの構成です。 Azure Cosmos DB for NoSQL コンテナーを作成するには、まずアカウントを作成してから、その後データベースを作成するという順序で行う必要があります。

このラボでは、データ エクスプローラーでさまざまな方法を使用して、スループットをプロビジョニングします。 スループットは、手動で、または自動スケーリングを使用して、データベースおよびコンテナー レベルでプロビジョニングします。

## サーバーレス アカウントを作成する

まず、サーバーレス アカウントを作成しましょう。 すべてがサーバーレスであるため、ここで構成することは多くありません。 データベースとコンテナーを作成するときに、スループットをプロビジョニングする必要はまったくありません。 このアカウントの作成に進めば、そのすべてがわかります。

1. 新しい Web ブラウザー ウィンドウまたはタブで、Azure portal (``portal.azure.com``) に移動します。

1. ご利用のサブスクリプションに関連付けられている Microsoft 資格情報を使用して、ポータルにサインインします。

1. **[Azure サービス]** カテゴリで、**[リソースの作成]** を選択してから、**[Azure Cosmos DB]** を選択します。

    > &#128161; または、**[&#8801;]** メニューを展開し、**[すべてのサービス]** を選択し、**[データベース]** カテゴリで、**[Azure Cosmos DB]** を選んでから **[作成]** を選択します。

1. **[API オプションの選択]** ペインで、**[Azure Cosmos DB for NoSQL]** セクションの **[作成]** オプションを選びます。

1. **[Azure Cosmos DB アカウントの作成]** ペイン内で、**[基本]** タブを確認します。

1. **[基本]** タブで、各設定に対して次の値を入力します。

    | **設定** | **Value** |
    | --: | :-- |
    | **サブスクリプション** | **既存の Azure サブスクリプションを使用します。** *すべてのリソースはリソース グループに属している必要があります。すべてのリソース グループはサブスクリプションに属している必要があります。* |
    | **リソース グループ** | **既存のリソース グループを使うか、新しいリソース グループを作成します。** *すべてのリソースは、リソース グループに属している必要があります。*|
    | **取引先企業名** |  **グローバルに一意の名前を入力します。** *グローバルに一意のアカウント名。この名前は、要求の DNS アドレスの一部として使用されます。ポータルでは、名前をリアルタイムで確認します。* |
    | **場所** | **使用可能なリージョンを選びます。** *データベースが最初にホストされる地理的リージョンを選択します。* |
    | **容量モード** | ''**[サーバーレス] を選択します**'' |

1. **[確認と作成]** を選択して **[確認と作成]** タブに移動してから、 **[作成]** を選択します。

    > &#128221; Azure Cosmos DB for NoSQL アカウントが使用できる状態になるまで、10 分から 15 分かかる場合があります。

1. **[デプロイ]** ペインを確認します。 デプロイが完了すると、そのペインが更新され、 **[デプロイに成功しました]** というメッセージが表示されます。

1. 引き続き **[デプロイ]** ペインで、**[リソースに移動]** を選択します。

1. **[Azure Cosmos DB アカウント]** ペインで、リソース メニューから **[データ エクスプローラー]** を選択します。

1. **[データ エクスプローラー]** ペインで、**[新しいコンテナー]** を展開してから、**[新しいデータベース]** を選択します。

1. **[新しいデータベース]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **Value** |
    | --: | :-- |
    | **データベース ID** | *`cosmicworks`* |

1. **[データ エクスプローラー]** ペインに戻り、階層内の **cosmicworks** データベース ノードを確認します。

1. **[データ エクスプローラー]** ペインで、 **[新しいコンテナー]** を選択します。

1. **[新しいコンテナー]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **Value** |
    | --: | :-- |
    | **データベース ID** | ''*既存の* &vert; *cosmicworks を使用します*'' |
    | **コンテナー ID** | *`products`* |
    | **パーティション キー** | *`/categoryId`* |

1. **[データ エクスプローラー]** ペインに戻り、**cosmicworks** データベース ノードを展開して、階層内の **products** コンテナー ノードを確認します。

1. Azure portal の **[ホーム]** に戻ります。

## プロビジョニングされたアカウントを作成する

次は、従来の構成オプションを使用してプロビジョニングされたスループット アカウントを作成します。 この種のアカウントを使用すると、少し面倒になる可能性がある構成オプションの世界が開きます。 ここでは、可能なデータベースとコンテナーの組み合わせの例についていくつか説明します。

1. **[Azure サービス]** カテゴリで、**[リソースの作成]** を選択してから、**[Azure Cosmos DB]** を選択します。

    > &#128161; または、**[&#8801;]** メニューを展開し、**[すべてのサービス]** を選択し、**[データベース]** カテゴリで、**[Azure Cosmos DB]** を選んでから **[作成]** を選択します。

1. **[API オプションの選択]** ペインで、**[Azure Cosmos DB for NoSQL]** セクションの **[作成]** オプションを選びます。

1. **[Azure Cosmos DB アカウントの作成]** ペイン内で、**[基本]** タブを確認します。

1. **[基本]** タブで、各設定に対して次の値を入力します。

    | **設定** | **Value** |
    | --: | :-- |
    | **サブスクリプション** | **既存の Azure サブスクリプションを使用します。** *すべてのリソースはリソース グループに属している必要があります。すべてのリソース グループはサブスクリプションに属している必要があります。* |
    | **リソース グループ** | **既存のリソース グループを使うか、新しいリソース グループを作成します。** *すべてのリソースは、リソース グループに属している必要があります。*|
    | **取引先企業名** |  **グローバルに一意の名前を入力します。** *グローバルに一意のアカウント名。この名前は、要求の DNS アドレスの一部として使用されます。ポータルでは、名前をリアルタイムで確認します。* |
    | **場所** | **使用可能なリージョンを選びます。** *データベースが最初にホストされる地理的リージョンを選択します。* |
    | **容量モード** | **プロビジョニング済みスループット** |
    | **Apply Free Tier Discount (Free レベル割引の適用)** | **適用しない** |
    | **このアカウントでプロビジョニングできるスループットの総量を制限する** | **Unchecked** |

1. **[確認と作成]** を選択して **[確認と作成]** タブに移動してから、 **[作成]** を選択します。

    > &#128221; Azure Cosmos DB for NoSQL アカウントが使用できる状態になるまで、10 分から 15 分かかる場合があります。

1. **[デプロイ]** ペインを確認します。 デプロイが完了すると、そのペインが更新され、 **[デプロイに成功しました]** というメッセージが表示されます。

1. 引き続き **[デプロイ]** ペインで、**[リソースに移動]** を選択します。

1. **[Azure Cosmos DB アカウント]** ペインで、リソース メニューから **[データ エクスプローラー]** を選択します。

1. **[データ エクスプローラー]** ペインで、**[新しいコンテナー]** を展開してから、**[新しいデータベース]** を選択します。

1. **[新しいデータベース]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **Value** |
    | --: | :-- |
    | **データベース ID** | *`nothroughputdb`* |
    | **スループットのプロビジョニング** | *Unchecked* |

1. **[データ エクスプローラー]** ペインに戻り、階層内の **nothroughputdb** データベース ノードを確認します。

1. **[データ エクスプローラー]** ペインで、 **[新しいコンテナー]** を選択します。

1. **[新しいコンテナー]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **Value** |
    | --: | :-- |
    | **データベース ID** | ''*既存の* &vert; *nothroughputdb を使用します*'' |
    | **コンテナー ID** | *`requiredthroughputcontainer`* |
    | **パーティション キー** | *`/primarykey`* |
    | **コンテナーのスループット** | *[手動]* |
    | **RU/秒** | *`400`* |

1. **[データ エクスプローラー]** ペインに戻り、**nothroughputdb** データベース ノードを展開し、階層内の **requiredthroughputcontainer** コンテナー ノードを確認します。

1. **[データ エクスプローラー]** ペインで、**[新しいコンテナー]** を展開してから、**[新しいデータベース]** を選択します。

1. **[新しいデータベース]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **Value** |
    | --: | :-- |
    | **データベース ID** | *`manualthroughputdb`* |
    | **スループットのプロビジョニング** | *オン* |
    | **データベースのスループット** | *[手動]* |
    | **RU/秒** | *`400`* |

1. **[データ エクスプローラー]** ペインに戻り、階層内の **manualthroughputdb** データベース ノードを確認します。

1. **[データ エクスプローラー]** ペインで、 **[新しいコンテナー]** を選択します。

1. **[新しいコンテナー]** ポップアップで、各設定に次の値を入力してから **[OK]** を選択します。

    | **設定** | **Value** |
    | --: | :-- |
    | **データベース ID** | ''既存の &vert; *manualthroughputdb* を使用します''** |
    | **コンテナー ID** | *`childcontainer`* |
    | **パーティション キー** | *`/primarykey`* |
    | **このコンテナーの専用スループットをプロビジョニングする** | *オン* |
    | **コンテナーのスループット** | *[手動]* |
    | **RU/秒** | *`1000`* |

1. **[データ エクスプローラー]** ペインに戻り、**manualthroughputdb** データベース ノードを展開し、階層内の **childcontainer** コンテナー ノードを確認します。
